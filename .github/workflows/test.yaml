name: Deploy

on: [pull_request]

concurrency: '1'

jobs:
  build:
    runs-on: Ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
      - run: |
          set +x
          echo $GITHUB_ACTOR
          git config user.name $GITHUB_ACTOR
          git config user.email $GITHUB_ACTOR@users.noreply.github.com
          git branch
          # git fetch origin storybook-static || true
          TEMP_DIR=$(mktemp -d)
          CURRENT_BRANCH=$(git branch --show-current)
          if ! git fetch origin storybook-static; then
            echo "Create storybook-static branch"
            git checkout --orphan storybook-static
            git rm --cached -r .
            git add -A .
            git commit -am "Init"
            git push --set-upstream origin storybook-static
            git checkout $CURRENT_BRANCH
          fi

          echo "Hello done"
